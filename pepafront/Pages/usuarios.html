<div class="titulo_menu">{{usuarios.form_title}}</div>
<uib-tabset active="usuarios.active" class="bg-local-black">
    <uib-tab index="0" heading="Grilla" ui-sref=".({action:'lista'})">
        <div class="w-100">
            <grilla gridoptions="usuarios.gridOptions" onclick-edit="usuarios.toggle(accion)"
                onclick-add="usuarios.toggle(accion)" onclick-copy="usuarios.toggle(accion)"
                onclick-delete="usuarios.confirmDelete()" urlback="usuarios" api="usuarios.grilla=API"
                class="d-flex flex-column w-100" style="height: 520px;" />
        </div>
    </uib-tab>
    <uib-tab index="1" ui-sref=".({action:'detalle'})" heading="Detalle">
        <div class="container-fluid">
            <div class="row justify-content-md-center w-100">
                <div class="col-md-6 col-lg-5">
                    <div class="form-group">
                        <label for="cod_usuario_dt" class="col-sm-10 label-adjust" translate>Cód. Usuario <span
                                class="field-required">*</span></label>
                        <input type="text" class="form-control form-control-sm" id="cod_usuario_dt"
                            name="cod_usuario_dt" placeholder="Cód. Usuario" ng-model="usuarios.usuario_dt.cod_usuario"
                            readonly="">
                    </div>

                    <div class="form-group">
                        <label for="cod_persona_dt" class="col-sm-10 label-adjust" translate>Cód. Persona <span
                                class="field-required">*</span></label>
                        <input type="text" class="form-control form-control-sm" id="cod_persona_dt"
                            name="cod_persona_dt" placeholder="Cód. Persona" ng-model="usuarios.usuario_dt.cod_persona"
                            readonly="">
                    </div>

                    <div class="form-group">
                        <label for="obj_permisos" class="col-sm-10 label-adjust" translate>Permisos</label>
                        <ui-select multiple ng-model="usuarios.usuario.obj_permisos" append-to-body="true"
                            close-on-select="false" disabled="">
                            <ui-select-match ui-lock-choice="true"
                                placeholder="Permisos">{{$item.nom}}</ui-select-match>
                            <ui-select-choices
                                repeat="hability.den as hability in usuarios.obj_permisos | filter: $select.search">
                                <div ng-bind-html="hability.nom | highlight: $select.search"></div>
                            </ui-select-choices>
                        </ui-select>
                    </div>

                    <div class="form-group">
                        <label for="obj_ou_dt" class="col-sm-10 label-adjust" translate>Organizaciones</label>
                        <ui-select multiple ng-model="usuarios.usuario_dt.obj_ou" append-to-body="true"
                            close-on-select="false" disabled="">
                            <ui-select-match ui-lock-choice="true"
                                placeholder="Organizaciones">{{$item.nom_ou}}</ui-select-match>
                            <ui-select-choices repeat="ou.cod_ou as ou in usuarios.obj_ou | filter: $select.search">
                                <div ng-bind-html="ou.nom_ou | highlight: $select.search"></div>
                            </ui-select-choices>
                        </ui-select>
                    </div>

                    <div class="form-group">
                        <label for="obj_sectores_dt" class="col-sm-10 label-adjust" translate>Sectores</label>
                        <ui-select multiple ng-model="usuarios.usuario_dt.obj_sectores" append-to-body="true"
                            close-on-select="false" disabled="">
                            <ui-select-match ui-lock-choice="true"
                                placeholder="Sectores">{{$item.nom_sector}}</ui-select-match>
                            <ui-select-choices
                                repeat="sector.cod_sector as sector in usuarios.obj_sectores | filter: $select.search">
                                <div ng-bind-html="sector.nom_sector | highlight: $select.search"></div>
                            </ui-select-choices>
                        </ui-select>
                    </div>

                    <div class="form-group ">
                        <label for="lector_dt" class="col-sm-10 label-adjust" translate>Lector</label>
                        <ui-select class="form-control form-control-sm" id="lector_dt" name="lector_dt"
                            ng-model="usuarios.usuario_dt.cod_tema_lector" disabled=""
                            ng-options="key as value.descripcion for (key,value) in usuarios.lectores">
                        </ui-select>
                    </div>

                </div>
                <div class="col-md-6 col-lg-5">

                    <div class="form-group">
                        <label for="obj_esquemas_dt" class="col-sm-10 label-adjust" translate>Esquemas</label>
                        <ui-select multiple ng-model="usuarios.usuario_dt.obj_esquemas" append-to-body="true"
                            close-on-select="false" disabled="">
                            <ui-select-match ui-lock-choice="true"
                                placeholder="Esquemas">{{$item.des_esquema_acceso}}</ui-select-match>
                            <ui-select-choices
                                repeat="esquema.cod_esquema_acceso as esquema in usuarios.obj_esquemas | filter: $select.search">
                                <div ng-bind-html="esquema.des_esquema_acceso | highlight: $select.search"></div>
                            </ui-select-choices>
                        </ui-select>
                    </div>

                    <div class="form-group ">
                        <label for="sector_default_dt" class="col-sm-10 label-adjust" translate>Sector Default Visita</label>
                        <ui-select class="form-control form-control-sm" id="sector_default_dt" name="sector_default_dt"
                            ng-model="usuarios.usuario_dt.sector_default" disabled=""
                            xng-options="item.cod_sector as item.nom_sector for item in usuarios.obj_sectores">
                            <ui-select-match placeholder="Sectores"><span
                                    ng-bind="$select.selected.nom_sector"></span></ui-select-match>
                            <ui-select-choices
                                repeat="item.cod_sector as item in usuarios.obj_sectores | filter: $select.search">
                                <div ng-bind-html="item.nom_sector | highlight: $select.search"></div>
                            </ui-select-choices>

                        </ui-select>
                    </div>

                    <div class="form-group">
                        <label for="esquema_default_dt" class="col-sm-10 label-adjust" translate>Esquema Default Visita</label>
                        <ui-select class="form-control form-control-sm" id="esquema_default_dt" name="esquema_default_dt"
                            ng-model="usuarios.usuario_dt.esquema_default" disabled=""
                            xng-options="item.cod_esquema_acceso as item.des_esquema_acceso for item in usuarios.obj_esquemas"
                            >
                            <ui-select-match placeholder="Esquemas">{{$item.des_esquema_acceso}}</ui-select-match>
                            <ui-select-choices
                                repeat="esquema.cod_esquema_acceso as esquema in usuarios.obj_esquemas | filter: $select.search">
                                <div ng-bind-html="esquema.des_esquema_acceso | highlight: $select.search"></div>
                            </ui-select-choices>

                        </ui-select>
                    </div>

                    <div class="form-group">
                        <label for="ruta_login_dt" class="col-sm-10 label-adjust" translate>Ruta Login </label>
                        <input type="text" class="form-control form-control-sm" id="ruta_login_dt" name="ruta_login_dt"
                            placeholder="Ruta Login" ng-model="usuarios.usuario_dt.ruta_login" readonly="">
                    </div>

                    <div class="form-group">
                        <label for="ind_estado_dt" class="col-sm-10 label-adjust" translate>Bloqueado</label>
                        <input class="checkbox-inline" type="checkbox" id="ind_estado_dt" name="ind_estado_dt"
                            ng-model="usuarios.usuario_dt.ind_estado" disabled="">
                    </div>

                    <div class="form-group">
                        <label for="ind_estado_dt" class="col-sm-10 label-adjust" translate>Visita Vista Simplificada</label>
                        <input class="checkbox-inline" type="checkbox" id="ind_visita_simplificada_dt"
                            name="ind_visita_simplificada_dt" ng-model="usuarios.usuario_dt.ind_visita_simplificada"
                            disabled="">
                    </div>

                    <!-- div class="form-group">
                        <label for="contrasena_dt" class="col-sm-10 label-adjust">Contraseña <span class="field-required">*</span></label>
                        <input type="password" class="form-control form-control-sm" id="contrasena_dt" name="contrasena_dt" placeholder="contraseña"
                               ng-model="usuarios.usuario_dt.contrasena" readonly="">
                    </div -->
                </div>
            </div>
            <div class="modal-footer p-2">
                <span class="legend-line">(<span class="field-required">*</span>: campo requerido)</span>
            </div>
        </div>
    </uib-tab>
    <uib-tab index="2" heading="{{usuarios.action_title}}" ui-sref=".({action:usuarios.action})"
        ng-hide="usuarios.hide">
        <div class="container-fluid">
            <form name="frmUsuarios" class="form-horizontal" novalidate ng-validator>
                <div class="row justify-content-md-center w-100">
                    <div class="col-md-6 col-lg-5">
                        <div class="form-group">
                            <label for="cod_usuario" class="col-sm-10 label-adjust" translate>Cód. Usuario <span
                                    class="field-required">*</span></label>
                            <input type="text" class="form-control form-control-sm" id="cod_usuario" name="cod_usuario"
                                placeholder="Cód. Usuario" ng-model="usuarios.usuario.cod_usuario" ng-required="true"
                                ng-readonly="usuarios.noteditable">
                            <span class="help-inline"
                                ng-show="frmUsuarios.cod_usuario.$invalid && frmUsuarios.cod_usuario.$touched" translate>Debe ingresar un Cód. Usuario</span>
                        </div>

                        <div class="form-group">
                            <label for="busq_persona" class="col-sm-10 label-adjust" translate>Buscar Persona</label>
                            <input type="text" class="form-control form-control-sm" id="busq_persona"
                                name="busq_persona" placeholder="DNI o Apellido Nombre Persona"
                                ng-model="usuarios.usuario.busq_persona" ng-readonly="usuarios.noteditable"
                                typeahead-append-to-body="true"
                                typeahead-on-select="usuarios.typeaheadOnSelect($item,$model,$label)"
                                uib-typeahead="obj as obj.des_persona for obj in usuarios.getDatosPersona($viewValue) | limitTo:8"
                                typeahead-loading="loading" typeahead-min-length="2" typeahead-wait-ms="300">
                            <span class="help-inline"
                                ng-show="frmUsuarios.usuario.busq_persona.$invalid && frmUsuarios.usuario.busq_persona.$touched" translate>Debe ingresar un DNI o Apellido Nombre Persona</span>
                        </div>

                        <div class="form-group">
                            <label for="cod_persona" class="col-sm-10 label-adjust" translate>Cód. Persona <span
                                    class="field-required">*</span></label>
                            <input type="text" class="form-control form-control-sm" id="cod_persona" name="cod_persona"
                                placeholder="Cód. Persona" ng-model="usuarios.usuario.cod_persona" ng-required="true"
                                ng-readonly="true">
                            <span class="help-inline"
                                ng-show="frmUsuarios.cod_persona.$invalid && frmUsuarios.cod_persona.$touched" translate>Debe ingresar un Cód. Persona</span>
                        </div>

                        <div class="form-group">
                            <label for="obj_permisos" class="col-sm-10 label-adjust" translate>Permisos</label>
                            <ui-select multiple ng-model="usuarios.usuario.obj_permisos" append-to-body="true"
                                close-on-select="false">
                                <ui-select-match placeholder="Permisos">{{$item.nom}}</ui-select-match>
                                <ui-select-choices
                                    repeat="hability.den as hability in usuarios.obj_permisos | filter: $select.search">
                                    <div ng-bind-html="hability.nom | highlight: $select.search"></div>
                                </ui-select-choices>
                            </ui-select>
                        </div>

                        <div class="form-group">
                            <label for="obj_ou" class="col-sm-10 label-adjust" translate>Organizaciones</label>
                            <ui-select multiple ng-model="usuarios.usuario.obj_ou" append-to-body="true"
                                close-on-select="false">
                                <ui-select-match placeholder="Organizaciones">{{$item.nom_ou}}</ui-select-match>
                                <ui-select-choices repeat="ou.cod_ou as ou in usuarios.obj_ou | filter: $select.search">
                                    <div ng-bind-html="ou.nom_ou | highlight: $select.search"></div>
                                </ui-select-choices>
                            </ui-select>
                        </div>

                        <div class="form-group">
                            <label for="obj_sectores" class="col-sm-10 label-adjust" translate>Sectores</label>
                            <ui-select multiple ng-model="usuarios.usuario.obj_sectores" append-to-body="true"
                                close-on-select="false">
                                <ui-select-match placeholder="Sectores">{{$item.nom_sector}}</ui-select-match>
                                <ui-select-choices
                                    repeat="sector.cod_sector as sector in usuarios.obj_sectores | filter: $select.search">
                                    <div ng-bind-html="sector.nom_sector | highlight: $select.search"></div>
                                </ui-select-choices>
                            </ui-select>
                        </div>

                        <div class="form-group ">
                            <label for="cod_tema_lector" class="col-sm-10 label-adjust" translate>Lector</label>
                            <ui-select class="form-control form-control-sm" id="cod_tema_lector" name="cod_tema_lector"
                                ng-model="usuarios.usuario.cod_tema_lector">
                                <option value="" translate>No requiere</option>
                                <ui-select-match placeholder="Lector"><span
                                        ng-bind="$select.selected.value"></span></ui-select-match>
                                <ui-select-choices
                                    repeat="item.key as item in usuarios.lectores | filter: $select.search">
                                    <div ng-bind-html="item.value | highlight: $select.search"></div>
                                </ui-select-choices>

                            </ui-select>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-5">

                        <div class="form-group">
                            <label for="obj_esquemas" class="col-sm-10 label-adjust" translate>Esquemas</label>
                            <ui-select multiple ng-model="usuarios.usuario.obj_esquemas" append-to-body="true"
                                close-on-select="false">
                                <ui-select-match placeholder="Esquemas">{{$item.des_esquema_acceso}}</ui-select-match>
                                <ui-select-choices
                                    repeat="esquema.cod_esquema_acceso as esquema in usuarios.obj_esquemas | filter: $select.search">
                                    <div ng-bind-html="esquema.des_esquema_acceso | highlight: $select.search"></div>
                                </ui-select-choices>
                            </ui-select>
                        </div>

                        <div class="form-group ">
                            <label for="sector_default" class="col-sm-10 label-adjust" translate>Sector Default Visita</label>
                            <ui-select class="form-control form-control-sm" id="sector_default" name="sector_default"
                                placeholder="Sector" ng-model="usuarios.usuario.sector_default">
                                <ui-select-match placeholder="Esquemas"><span
                                        ng-bind="$select.selected.nom_sector"></span></ui-select-match>
                                <ui-select-choices
                                    repeat="item.cod_sector as item in usuarios.obj_sectores | filter: $select.search">
                                    <div ng-bind-html="item.nom_sector | highlight: $select.search"></div>
                                </ui-select-choices>

                            </ui-select>
                        </div>

                        <div class="form-group ">
                            <label for="esquema_default" class="col-sm-10 label-adjust" translate>Esquema Default Visita</label>
                            <ui-select class="form-control form-control-sm" id="esquema_default" name="esquema_default"
                                ng-model="usuarios.usuario.esquema_default"
                                >
                                <ui-select-match placeholder="Esquema" ><span ng-bind="$select.selected.des_esquema_acceso"></span></ui-select-match>
                                <ui-select-choices repeat="item.cod_esquema_acceso as item in usuarios.obj_esquemas | filter: $select.search">
                                    <div ng-bind-html="item.des_esquema_acceso | highlight: $select.search"></div>
                                </ui-select-choices>

                            </ui-select>
                        </div>

                        <div class="form-group">
                            <label for="ruta_login" class="col-sm-10 label-adjust" translate>Ruta Login </label>
                            <input type="text" class="form-control form-control-sm" id="ruta_login" name="ruta_login"
                                placeholder="Ruta Login" ng-model="usuarios.usuario.ruta_login">
                        </div>

                        <div class="form-group">
                            <label for="ind_estado" class="col-sm-10 label-adjust" translate>Bloqueado</label>
                            <input class="checkbox-inline" type="checkbox" id="ind_estado" name="ind_estado"
                                ng-model="usuarios.usuario.ind_estado">
                        </div>

                        <div class="form-group">
                            <label for="ind_visita_simplificada" class="col-sm-10 label-adjust" translate>Visita Vista Simplificada</label>
                            <input class="checkbox-inline" type="checkbox" id="ind_visita_simplificada"
                                name="ind_visita_simplificada" ng-model="usuarios.usuario.ind_visita_simplificada">
                        </div>

                        <div class="form-group">
                            <label for="contrasena" class="col-sm-10 label-adjust" translate>Contraseña <span
                                    class="field-required">*</span></label>
                            <input type="password" class="form-control form-control-sm" id="contrasena"
                                name="contrasena" placeholder="contraseña" ng-model="usuarios.usuario.contrasena"
                                ng-required="false">
                            <span class="help-inline"
                                ng-show="frmUsuarios.contrasena.$invalid && frmUsuarios.contrasena.$touched" translate>Debe ingresar una contraseña</span>
                        </div>
                    </div>
                </div>
                <div class="modal-footer p-2">
                    <span class="legend-line">(<span class="field-required">*</span>: campo requerido)</span>
                    <!--Use "ng-mousedown" (occurring earlier) instead of "ng-click" to avoid previous focused input element "on-blur" action before clicking Add button-->
                    <button dtcancela hide-tab="usuarios.hide" type="button"
                        class="btn btn-outline-danger btn-sm" translate>Cancelar</button>
                    <button type="button" class="btn btn-outline-success btn-sm"
                        ng-class="{'modal-button-primary': frmUsuarios.$valid, 'modal-button-primary-disabled': !(frmUsuarios.$valid && frmUsuarios.$dirty)} "
                        ng-disabled="!(frmUsuarios.$dirty)"
                        click-and-disable="usuarios.ok()">&#160;<span translate>Grabar</span>&#160;</button>
                </div>
            </form>
        </div>
    </uib-tab>
</uib-tabset>